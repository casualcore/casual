<?xml version="1.0"?>
<domain>
 <queue>
  <note>retry.count - if number of rollbacks is greater, message is moved to error-queue  retry.delay - the amount of time before the message is available for consumption, after rollback
</note>
  <default>
   <queue>
    <retry>
     <count>3</count>
     <delay>20s</delay>
    </retry>
   </queue>
   <directory>${CASUAL_DOMAIN_HOME}/queue/groups</directory>
  </default>
  <groups>
   <element>
    <alias>A</alias>
    <note>will get default queuebase: ${CASUAL_DOMAIN_HOME}/queue/groups/A.qb</note>
    <queues>
     <element>
      <name>a1</name>
      <enable>
       <enqueue>true</enqueue>
       <dequeue>false</dequeue>
      </enable>
      <note>dequeue is disabled -&gt; dequeue will give no_queue error (unless the queue is found elsewhere)</note>
     </element>
     <element>
      <name>a2</name>
      <retry>
       <count>10</count>
       <delay>100ms</delay>
      </retry>
      <note>after 10 rollbacked dequeues, message is moved to a2.error</note>
     </element>
     <element>
      <name>a3</name>
     </element>
     <element>
      <name>a4</name>
     </element>
    </queues>
   </element>
   <element>
    <alias>B</alias>
    <queuebase>/some/fast/disk/queue/groupB.qb</queuebase>
    <queues>
     <element>
      <name>b1</name>
     </element>
     <element>
      <name>b2</name>
      <retry>
       <count>20</count>
      </retry>
      <note>after 20 rollbacked dequeues, message is moved to b2.error. retry.delay is 'inherited' from default, if any</note>
     </element>
    </queues>
   </element>
   <element>
    <alias>C</alias>
    <queuebase>:memory:</queuebase>
    <note>group is an in-memory queue, hence no persistence</note>
    <queues>
     <element>
      <name>c1</name>
     </element>
     <element>
      <name>c2</name>
     </element>
    </queues>
   </element>
   <element>
    <alias>D</alias>
    <note>group limited to a total message size of 10KiB, after which further enqueues will give no_queue error</note>
    <capacity>
     <size>10KiB</size>
    </capacity>
    <queues>
     <element>
      <name>d1</name>
     </element>
     <element>
      <name>d2</name>
     </element>
    </queues>
   </element>
  </groups>
  <forward>
   <default>
    <service>
     <instances>3</instances>
     <reply>
      <delay>2s</delay>
     </reply>
    </service>
    <queue>
     <instances>1</instances>
     <target>
      <delay>500ms</delay>
     </target>
    </queue>
   </default>
   <groups>
    <element>
     <alias>forward-group-1</alias>
     <services>
      <element>
       <alias>fwd-b1</alias>
       <source>b1</source>
       <instances>4</instances>
       <target>
        <service>casual/example/echo</service>
       </target>
       <reply>
        <queue>a3</queue>
        <delay>10ms</delay>
       </reply>
      </element>
     </services>
     <queues>
      <element>
       <alias>fwd-c1</alias>
       <source>c1</source>
       <note>gets the alias 'c1'</note>
       <target>
        <queue>a4</queue>
       </target>
      </element>
     </queues>
    </element>
    <element>
     <alias>forward-group-2</alias>
     <services>
      <element>
       <alias>bar</alias>
       <source>b2</source>
       <note>will get alias b2</note>
       <target>
        <service>casual/example/echo</service>
       </target>
      </element>
      <element>
       <source>b2</source>
       <note>will get alias b2.2</note>
       <target>
        <service>casual/example/sink</service>
       </target>
      </element>
     </services>
    </element>
   </groups>
  </forward>
 </queue>
</domain>

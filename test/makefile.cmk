from casual.middleware.make.dsl import *

IncludePaths( ['include',
	'../middleware/common/include',
	'../middleware/serviceframework/include',
	'../middleware/xatmi/include',
	'../middleware/queue/include',
	'../middleware/buffer/include',
	'$(CASUAL_OPTIONAL_INCLUDE_PATHS)',
    ])
LibraryPaths( [ 'bin',
	'../middleware/xatmi/bin',
	'../middleware/common/bin',
	'../middleware/queue/bin',
	'../middleware/buffer/bin',
   '../middleware/retry/bin',
	'../middleware/serviceframework/bin',
   '../middleware/configuration/bin',
   '../middleware/http/bin',
	'$(CASUAL_OPTIONAL_LIBRARY_PATHS)',
	])



install_bin = []


test_archive = LinkArchive( 'bin/test-archive', 
  [
    Compile( 'source/domain.cpp'),
  ]
)

# unittest

LinkUnittest( 'unittest/bin/test-casual-basic',
    [
	    Compile( 'unittest/source/domain/test_basic.cpp'),
        # activate when we got nginx build working, 
        Compile( 'unittest/source/domain/test_http.cpp'),
	],
    [ 
        test_archive,
		'casual-common', 
		'casual-serviceframework', 
		'casual-xatmi', 
		'yaml-cpp', 
		'casual-mockup',
        'casual-mockup-log',
		'casual-unittest',
	])
	

#
# Install
#
Install( install_bin,'$(CASUAL_HOME)/bin')







	
	
